<% content_for :head do %>
  <%= javascript_include_tag 'items' %>
<% end %>
<% if @user %>
  <% if @user == current_user %>
    <div class="button new">
      <%= link_to t("resource.new"), new_item_path %>
    </div>
  <% end %>
<% end %>               
<% if params[:search] || @items_count %><div class="content-order-panel status-bar ui-corner-all font-smaller"><% end %>
<p><%= @search_sql %></p>
<% if @items_count %>
  <span><%= t((@searchItemType.downcase), :count => @items_count) %> <%= t("found") if !params[:user_id] %></span>  
  <%= render :partial => "share/tags", :locals => {:tags => @tags, :tagtype => @tagtype} if @tags || @tagtype %>
  <%= render :partial => "share/panel_spacer" %>
  <%= render :partial => "orderBy" if params[:search] %>
<% end %>
<%= render :partial => "share/panel_spacer" %>
<% if params[:search] %>
  <% if @keywords %>
    <% @keywords.each do |keyword|  %>
      <span><span class="keyword"><%= keyword %></span> was searched in <%= @searchItemType %>s <b><%= search_count(keyword) %></b> times</span>
    <% end %>
  <% end %>
<% end %>
<% if params[:search] || @items_count %></div><% end %>

<% if @user and !params[:search] %> 

  <div class="sub2cols">
    <div class="subcol1">
      <% if @items_needed.size > 0 %>
        <h2><%= t("title.resources.#{@userSubtitle}Need", :user => @user.login) %> (<%= @items_needed.size %>)</h2>
        <div class="block ui-corner-all">
          <%= render :partial => "share/items_needed_offered", :locals => {:resources => @resources_needed, :itemTypes => @itemTypes, :need => 1 } %>
        </div> 
      <% end %>
    </div>
    
    <div class="subcol2">   
      <% if @items_offered.size > 0 %>
        <h2><%= t("title.resources.#{@userSubtitle}Have", :user => @user.login) %> (<%= @items_offered.size %>)</h2>
        <div class="block ui-corner-all">
          <%= render :partial => "share/items_needed_offered", :locals => {:resources => @resources_offered, :itemTypes => @itemTypes, :need => 0 } %>
        </div>
      <% end %>
    </div>
    
  </div> 
  <div class="sub2cols">
  
    <div class="subcol1"> 
      <% if @items_taken.size > 0 %>
       <h2><%= t("title.resources.#{@userSubtitle}HaveTaken", :user => @user.login) %> (<%= @items_taken.size %>)</h2>
        <div class="block ui-corner-all">
          <%= render :partial => "share/items_given_taken", :locals => {:resources => @resources_taken, :itemTypes => @itemTypes, :taken => 1 } %>
        </div>
      <% end %>     
    </div>
    
    <div class="subcol1">
      <% if @items_given.size > 0 %>
        <h2><%= t("title.resources.#{@userSubtitle}HaveGiven", :user => @user.login) %> (<%= @user.items_given.size %>)</h2>
        <div class="block ui-corner-all">
          <%= render :partial => "share/items_given_taken", :locals => {:resources => @resources_given, :itemTypes => @itemTypes, :taken => 0 } %>
        </div> 
      <% end %>
    </div>
    
  </div>
  
<% else %>
    <%= render :partial => "share/item_collection", :locals => {:collection => collection} %>
    <%= render :partial => "item", :collection => collection %>
    <%= render :partial => "share/item_collection", :locals => {:collection => collection} %>
<% end %>